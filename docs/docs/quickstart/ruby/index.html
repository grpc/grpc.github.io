<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cjyabraham.github.io/grpccss/style.css">
    <title>
   &ndash; gRPC
</title>
  </head>
  <body>

    <div id="landing-content">
      <div class="row">
        <div class="topbannersub">
          <div class="logonav">
                <img src="https://cjyabraham.github.io/grpcimg/grpc-logo.png" style="width:10%">
            </div>
            <div class="topnav">
                <a href="https://cjyabraham.github.io/grpcabout/">About</a>
		<a href="https://cjyabraham.github.io/grpcdocs/">Docs</a>
		<a href="https://cjyabraham.github.io/grpcblog/">Blog</a> 
		<a href="https://cjyabraham.github.io/grpccommunity/">Community</a>
		<a href="https://packages.grpc.io/">Packages</a> 
		<a href="https://cjyabraham.github.io/grpcfaq/">FAQ</a>
            </div>
    
            <div class="headertext"></div>
  </div>
        </div>
        </div>

  <div class="section2" style="text-align:left;margin-bottom:5%">
    

<p class="lead">This guide gets you started with gRPC in Ruby with a simple
working example.</p>

<div id="toc"></div>

<h2 id="before-you-begin">Before you begin</h2>

<h3 id="prerequisites">Prerequisites</h3>

<ul>
<li><code>ruby</code>: version 2 or higher</li>
</ul>

<h3 id="install-grpc">Install gRPC</h3>

<pre><code>$ gem install grpc
</code></pre>

<h3 id="install-grpc-tools">Install gRPC tools</h3>

<p>Ruby&rsquo;s gRPC tools include the protocol buffer compiler <code>protoc</code> and the special
plugin for generating server and client code from the <code>.proto</code> service
definitions. For the first part of our quickstart example, we&rsquo;ve already
generated the server and client stubs from
<a href="https://github.com/grpc/grpc/tree/{{site.data.config.grpc_release_tag}}/examples/protos/helloworld.proto">helloworld.proto</a>,
but you&rsquo;ll need the tools for the rest of our quickstart, as well as later
tutorials and your own projects.</p>

<p>To install gRPC tools, run:</p>

<pre><code class="language-sh">gem install grpc-tools
</code></pre>

<h2 id="download-the-example">Download the example</h2>

<p>You&rsquo;ll need a local copy of the example code to work through this quickstart.
Download the example code from our Github repository (the following command
clones the entire repository, but you just need the examples for this quickstart
and other tutorials):</p>

<pre><code class="language-sh">$ # Clone the repository to get the example code:
$ git clone -b {{ site.data.config.grpc_release_tag }} https://github.com/grpc/grpc
$ # Navigate to the &quot;hello, world&quot; Ruby example:
$ cd grpc/examples/ruby
</code></pre>

<h2 id="run-a-grpc-application">Run a gRPC application</h2>

<p>From the <code>examples/ruby</code> directory:</p>

<ol>
<li>Run the server</li>
</ol>

<pre><code class="language-sh">   $ ruby greeter_server.rb
</code></pre>

<ol>
<li>In another terminal, run the client</li>
</ol>

<pre><code class="language-sh">   $ ruby greeter_client.rb
</code></pre>

<p>Congratulations! You&rsquo;ve just run a client-server application with gRPC.</p>

<h2 id="update-a-grpc-service">Update a gRPC service</h2>

<p>Now let&rsquo;s look at how to update the application with an extra method on the
server for the client to call. Our gRPC service is defined using protocol
buffers; you can find out lots more about how to define a service in a <code>.proto</code>
file in <a href="../tutorials/basic/ruby.html">gRPC Basics: Ruby</a>. For now all you need
to know is that both the server and the client &ldquo;stub&rdquo; have a <code>SayHello</code> RPC
method that takes a <code>HelloRequest</code> parameter from the client and returns a
<code>HelloResponse</code> from the server, and that this method is defined like this:</p>

<pre><code class="language-proto">// The greeting service definition.
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}
}

// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings
message HelloReply {
  string message = 1;
}
</code></pre>

<p>Let&rsquo;s update this so that the <code>Greeter</code> service has two methods. Edit
<code>examples/protos/helloworld.proto</code> and update it with a new <code>SayHelloAgain</code>
method, with the same request and response types:</p>

<pre><code class="language-proto">// The greeting service definition.
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}
  // Sends another greeting
  rpc SayHelloAgain (HelloRequest) returns (HelloReply) {}
}

// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings
message HelloReply {
  string message = 1;
}
</code></pre>

<p>(Don&rsquo;t forget to save the file!)</p>

<h2 id="generate-grpc-code">Generate gRPC code</h2>

<p>Next we need to update the gRPC code used by our application to use the new
service definition. From the <code>examples/ruby/</code> directory:</p>

<pre><code class="language-sh">$ grpc_tools_ruby_protoc -I ../protos --ruby_out=lib --grpc_out=lib ../protos/helloworld.proto
</code></pre>

<p>This regenerates <code>lib/helloworld_services_pb.rb</code>, which contains our generated
client and server classes.</p>

<h3 id="update-the-server">Update the server</h3>

<p>In the same directory, open <code>greeter_server.rb</code>. Implement the new method like this</p>

<pre><code class="language-rb">class GreeterServer &lt; Helloworld::Greeter::Service

  def say_hello(hello_req, _unused_call)
    Helloworld::HelloReply.new(message: &quot;Hello #{hello_req.name}&quot;)
  end

  def say_hello_again(hello_req, _unused_call)
    Helloworld::HelloReply.new(message: &quot;Hello again, #{hello_req.name}&quot;)
  end
end
...
</code></pre>

<h3 id="update-the-client">Update the client</h3>

<p>In the same directory, open <code>greeter_client.rb</code>. Call the new method like this:</p>

<pre><code>def main
  stub = Helloworld::Greeter::Stub.new('localhost:50051', :this_channel_is_insecure)
  user = ARGV.size &gt; 0 ?  ARGV[0] : 'world'
  message = stub.say_hello(Helloworld::HelloRequest.new(name: user)).message
  p &quot;Greeting: #{message}&quot;
  message = stub.say_hello_again(Helloworld::HelloRequest.new(name: user)).message
  p &quot;Greeting: #{message}&quot;
end
</code></pre>

<h3 id="run">Run!</h3>

<p>Just like we did before, from the <code>examples/ruby</code> directory:</p>

<ol>
<li>Run the server</li>
</ol>

<pre><code class="language-sh">   $ ruby greeter_server.rb
</code></pre>

<ol>
<li>In another terminal, run the client</li>
</ol>

<pre><code class="language-sh">   $ ruby greeter_client.rb
</code></pre>

<h2 id="what-s-next">What&rsquo;s next</h2>

<ul>
<li>Read a full explanation of how gRPC works in <a href="../guides/">What is gRPC?</a>
and <a href="../guides/concepts.html">gRPC Concepts</a></li>
<li>Work through a more detailed tutorial in <a href="../tutorials/basic/ruby.html">gRPC Basics: Ruby</a></li>
<li>Explore the gRPC Ruby core API in its <a href="http://www.rubydoc.info/gems/grpc">reference
documentation</a></li>
</ul>

  </div>

    
    
  </body>
</html>
