<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cjyabraham.github.io/grpccss/style.css">
    <title>
   &ndash; gRPC
</title>
  </head>
  <body>

    <div id="landing-content">
      <div class="row">
        <div class="topbannersub">
          <div class="logonav">
                <img src="https://cjyabraham.github.io/grpcimg/grpc-logo.png" style="width:10%">
            </div>
            <div class="topnav">
                <a href="https://cjyabraham.github.io/grpcabout/">About</a>
		<a href="https://cjyabraham.github.io/grpcdocs/">Docs</a>
		<a href="https://cjyabraham.github.io/grpcblog/">Blog</a> 
		<a href="https://cjyabraham.github.io/grpccommunity/">Community</a>
		<a href="https://packages.grpc.io/">Packages</a> 
		<a href="https://cjyabraham.github.io/grpcfaq/">FAQ</a>
            </div>
    
            <div class="headertext"></div>
  </div>
        </div>
        </div>

  <div class="section2" style="text-align:left;margin-bottom:5%">
    

<p class="lead">This guide gets you started with gRPC in Go with a simple
working example.</p>

<div id="toc"></div>

<h2 id="before-you-begin">Before you begin</h2>

<h3 id="prerequisites">Prerequisites</h3>

<h4 id="go-version">Go version</h4>

<p>gRPC requires Go 1.6 or higher.</p>

<pre><code class="language-sh">$ go version
</code></pre>

<p>For installation instructions, follow this guide: <a href="https://golang.org/doc/install">Getting Started - The Go Programming Language</a></p>

<h4 id="install-grpc">Install gRPC</h4>

<p>Use the following command to install gRPC.</p>

<pre><code class="language-sh">$ go get -u google.golang.org/grpc
</code></pre>

<h4 id="install-protocol-buffers-v3">Install Protocol Buffers v3</h4>

<p>Install the protoc compiler that is used to generate gRPC service code. The simplest way to do this is to download pre-compiled binaries for your platform(<code>protoc-&lt;version&gt;-&lt;platform&gt;.zip</code>) from here: <a href="https://github.com/google/protobuf/releases">https://github.com/google/protobuf/releases</a></p>

<ul>
<li>Unzip this file.</li>
<li>Update the environment variable <code>PATH</code> to include the path to the protoc binary file.</li>
</ul>

<p>Next, install the protoc plugin for Go</p>

<pre><code>$ go get -u github.com/golang/protobuf/protoc-gen-go
</code></pre>

<p>The compiler plugin, protoc-gen-go, will be installed in $GOBIN, defaulting to $GOPATH/bin. It must be in your $PATH for the protocol compiler, protoc, to find it.</p>

<pre><code>$ export PATH=$PATH:$GOPATH/bin
</code></pre>

<h2 id="download-the-example">Download the example</h2>

<p>The grpc code that was fetched with <code>go get google.golang.org/grpc</code> also contains the examples. They can be found under the examples dir: <code>$GOPATH/src/google.golang.org/grpc/examples</code>.</p>

<h2 id="build-the-example">Build the example</h2>

<p>Change to the example directory</p>

<pre><code>$ cd $GOPATH/src/google.golang.org/grpc/examples/helloworld
</code></pre>

<p>gRPC services are defined in a <code>.proto</code> file, which is used to generate a corresponding <code>.pb.go</code> file. The <code>.pb.go</code> file is generated by compiling the <code>.proto</code> file using the protocol compiler: <code>protoc</code>.</p>

<p>For the purpose of this example, the <code>helloworld.pb.go</code> file has already been generated (by compiling <code>helloworld.proto</code>), and can be found in this directory: <code>$GOPATH/src/google.golang.org/grpc/examples/helloworld/helloworld</code></p>

<p>This <code>helloworld.pb.go</code> file contains:</p>

<ul>
<li>Generated client and server code.</li>
<li>Code for populating, serializing, and retrieving our <code>HelloRequest</code> and <code>HelloReply</code> message types.</li>
</ul>

<h2 id="try-it">Try it!</h2>

<p>To compile and run the server and client code, the <code>go run</code> command can be used.
In the examples directory:</p>

<pre><code>$ go run greeter_server/main.go
</code></pre>

<p>From a different terminal:</p>

<pre><code>$ go run greeter_client/main.go
</code></pre>

<p>If things go smoothly, you will see the <code>Greeting: Hello world</code> in the client side output.</p>

<p>Congratulations! You&rsquo;ve just run a client-server application with gRPC.</p>

<h2 id="update-a-grpc-service">Update a gRPC service</h2>

<p>Now let&rsquo;s look at how to update the application with an extra method on the
server for the client to call. Our gRPC service is defined using protocol
buffers; you can find out lots more about how to define a service in a <code>.proto</code>
file in <a href="/docs/guides">What is gRPC?</a> and <a href="../tutorials/basic/go.html">gRPC Basics:
Go</a>. For now all you need to know is that both the server and the client
&ldquo;stub&rdquo; have a <code>SayHello</code> RPC method that takes a <code>HelloRequest</code> parameter from
the client and returns a <code>HelloReply</code> from the server, and that this method
is defined like this:</p>

<pre><code class="language-protobuf">// The greeting service definition.
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}
}

// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings
message HelloReply {
  string message = 1;
}
</code></pre>

<p>Let&rsquo;s update this so that the <code>Greeter</code> service has two methods. Make sure you are in the same examples dir as above (<code>$GOPATH/src/google.golang.org/grpc/examples/helloworld</code>)</p>

<p>Edit <code>helloworld/helloworld.proto</code> and update it with a new <code>SayHelloAgain</code> method, with the same request and response
types:</p>

<pre><code class="language-protobuf">// The greeting service definition.
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}
  // Sends another greeting
  rpc SayHelloAgain (HelloRequest) returns (HelloReply) {}
}

// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings
message HelloReply {
  string message = 1;
}
</code></pre>

<h2 id="generate-grpc-code">Generate gRPC code</h2>

<p>Next we need to update the gRPC code used by our application to use the new
service definition. From the same examples dir as above (<code>$GOPATH/src/google.golang.org/grpc/examples/helloworld</code>)</p>

<pre><code class="language-sh">$ protoc -I helloworld/ helloworld/helloworld.proto --go_out=plugins=grpc:helloworld
</code></pre>

<p>This regenerates the helloworld.pb.go with our new changes.</p>

<h2 id="update-and-run-the-application">Update and run the application</h2>

<p>We now have new generated server and client code, but we still need to implement
and call the new method in the human-written parts of our example application.</p>

<h3 id="update-the-server">Update the server</h3>

<p>Edit <code>greeter_server/main.go</code> and add the following function to it:</p>

<pre><code class="language-go">func (s *server) SayHelloAgain(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {
        return &amp;pb.HelloReply{Message: &quot;Hello again &quot; + in.Name}, nil
}
</code></pre>

<h3 id="update-the-client">Update the client</h3>

<p>Edit <code>greeter_client/main.go</code> to add the following code to the main function.</p>

<pre><code class="language-go">r, err = c.SayHelloAgain(ctx, &amp;pb.HelloRequest{Name: name})
if err != nil {
        log.Fatalf(&quot;could not greet: %v&quot;, err)
}
log.Printf(&quot;Greeting: %s&quot;, r.Message)
</code></pre>

<h3 id="run">Run!</h3>

<p>Run the server</p>

<pre><code>$ go run greeter_server/main.go
</code></pre>

<p>On a different terminal, run the client</p>

<pre><code>$ go run greeter_client/main.go
</code></pre>

<p>You should see the updated output:</p>

<pre><code>$ go run greeter_client/main.go
Greeting: Hello world
Greeting: Hello again world
</code></pre>

<h2 id="what-s-next">What&rsquo;s next</h2>

<ul>
<li>Read a full explanation of how gRPC works in <a href="../guides/">What is gRPC?</a>
and <a href="../guides/concepts.html">gRPC Concepts</a></li>
<li>Work through a more detailed tutorial in <a href="../tutorials/basic/go.html">gRPC Basics: Go</a></li>
<li>Explore the gRPC Go core API in its <a href="https://godoc.org/google.golang.org/grpc">reference
documentation</a></li>
</ul>

  </div>

    
    
  </body>
</html>
